# Implementation Plan: Wallet Info Navbar

**Branch**: `002-wallet-info-navbar` | **Date**: 2026-01-03 | **Spec**: [spec.md](spec.md)
**Input**: Feature specification from `/specs/002-wallet-info-navbar/spec.md`

## Summary

Implement a navbar that shows wallet information (address, balance, copy button, disconnect) for authenticated users, and a search dropdown when clicking the search bar. Replaces the profile avatar dropdown with wallet info display and adds search dropdown functionality.

## Technical Context

**Language/Version**: TypeScript 5 (strict mode)
**Primary Dependencies**: Next.js 15, React 19, NextAuth.js with SIWE
**Storage**: Session-based (no new storage needed)
**Testing**: Jest + React Testing Library
**Target Platform**: Web (desktop + mobile)
**Project Type**: Single project (Next.js App Router)
**Performance Goals**: LCP < 2.5s, dropdown open < 100ms
**Constraints**: Dark theme by default, responsive design
**Scale/Scope**: All authenticated users see wallet info

## Constitution Check

*GATE: Must pass before Phase 0 research. Re-check after Phase 1 design.*

| Rule | Status | Notes |
|------|--------|-------|
| Type Safety Everywhere | ✅ | TypeScript strict mode, typed session data |
| Wallet-First Identity | ✅ | Wallet info displayed prominently |
| Specification-Driven | ✅ | Following SDD-RI workflow |
| Security-First Web3 | ✅ | Clipboard API handled safely |
| Production-Grade UX | ✅ | Loading states, responsive, animations |

## Project Structure

### Documentation (this feature)

```text
specs/002-wallet-info-navbar/
├── plan.md              # This file (/sp.plan command output)
├── spec.md              # Feature specification
├── research.md          # Phase 0 output
├── data-model.md        # Phase 1 output (N/A - no new entities)
├── quickstart.md        # Phase 1 output
├── contracts/           # Phase 1 output (N/A - no API changes)
└── tasks.md             # Phase 2 output (/sp.tasks command)
```

### Source Code (repository root)

```text
src/
├── common/
│   ├── Header.tsx       # Modified - add wallet info display
│   └── SearchBar.tsx    # Modified - add click handler for dropdown
├── components/dashboard/
│   ├── SearchDropdown.tsx     # New - search dropdown component
│   └── FiltersDropdown.tsx    # Reference - similar pattern
└── app/
    └── dashboard/
        └── page.tsx     # Reference - uses DashboardContainer
```

**Structure Decision**: This is a frontend UI feature. Components go in `src/common/` (shared) or `src/components/dashboard/` (feature-specific). No backend changes needed.

## Phase 0: Research

### Unknowns to Resolve

1. **Wallet balance data source**: How to fetch real-time wallet balance?
   - Option A: Use existing price API endpoint
   - Option B: Mock for now, add API later
   - Option C: Use wagmi/viem to fetch on-chain

2. **Search dropdown positioning**: Handle edge cases on mobile/small screens
   - Option A: Use fixed positioning with overflow handling
   - Option B: Use Portal to render outside DOM hierarchy
   - Option C: Simple CSS max-height with scroll

### Research Tasks

- Research wallet balance fetching patterns in existing codebase
- Research dropdown positioning best practices for responsive design

## Phase 1: Design & Contracts

### Data Model (N/A)

This feature uses existing session data (wallet address from NextAuth) and mock data (balance, search results). No new entities needed.

### Component Contracts

1. **SearchDropdown Props**
   ```typescript
   interface SearchDropdownProps {
     isOpen: boolean
     onClose: () => void
   }
   ```

2. **WalletInfo Display** (inline in Header.tsx)
   ```typescript
   // Uses existing session.user.walletAddress
   // Mock balance: '$12,450.00'
   ```

### Quickstart

**Files to Create:**
- `src/components/dashboard/SearchDropdown.tsx`

**Files to Modify:**
- `src/common/Header.tsx` - Replace profile dropdown with wallet info
- `src/common/SearchBar.tsx` - Add onClick handler

**Key Decisions:**

| Decision | Choice | Rationale |
|----------|--------|-----------|
| Wallet balance | Mock | Simpler, API integration out of scope |
| Search results | Mock | UI first, search logic separate feature |
| Address format | `0x123...abcd` | Standard truncation pattern |
| Copy feedback | Check icon + 2s timeout | Clear visual confirmation |

## Phase 2: Tasks

Generated by `/sp.tasks` command after plan approval.

## Complexity Tracking

> No constitution violations. Feature uses existing patterns.
